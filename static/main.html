<html lang="eu">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<!-- Angular Material style sheet -->
		<link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/angular_material/1.1.0-rc2/angular-material.min.css">
		<!-- Bootstrap -->
		<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
		<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-material-design/4.0.1/bootstrap-material-design.css">
		<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/bootstrap.material-design/0.5.9/css/ripples.min.css">
		<link rel="stylesheet" type="text/css" href="/static/main.css">
	</head>
	<body ng-app="mainApp"  ng-cloak>
		<div ng-cloak>
		<md-tabs md-dynamic-height flex md-border-bottom>
			<md-tab label="Главная">
				<md-tab-body  >
					<div layout="row" class="bg-main calc">
						<div flex="65">
							<div class=" block height100 md-whiteframe-5dp"  ng-controller="tasksContoller" ng-cloak>
								<md-subheader class="md-no-sticky blue-title">Текущие заявки:</md-subheader>
								<div class="bs-component">
									<table class="table table-striped table-hover ">
									   <thead>
										  <tr>
											 <td>Дата подачи</td>
											 <td>Тема</td>
											 <td>Дата выполнения</td>
											 <td>Статус</td>
											 <td>Приоритет</td>

										  </tr>
									   </thead>
									   <tbody >
										  <tr data-toggle="collapse" ng-repeat-start="item in tasks track by $index" data-target="#colapsed{{$index}}" 
											  class="clickable collapsed">
											 <td>{{item.datestart}}</td>
											 <td>{{item.theme}}</td>
											 <td>{{item.dateend}}</td>
											 <td>{{item.status}}</td>
											 <td>{{item.priority}}</td>
										  </tr>
										 <tr ng-repeat-end>
											 <td colspan="5">
												 <div  id="colapsed{{$index}}" class="collapse">
													{{item.priority}}
												 </div>									
											 </td>
										 </tr>
									</tbody>
										
									</table>
										
								 </div>
								
							</div>
						</div>
						<div layout="column" flex="35" >
							
								<div class="block md-whiteframe-5dp" >
									<md-subheader class="md-no-sticky blue-title">Новая заявка:</md-subheader>
									<div layout-gt-xs="row">
									 <md-input-container flex-gt-xs>
										<label>ФИО:</label>
										<input ng-model="task.username" >
									 </md-input-container>
									 <md-input-container flex-gt-md>
										<label>Приоритет</label>
										<md-select ng-model="task.priority">
										   <md-option value="Hight">
											  Высокий
										   </md-option>
										   <md-option value="Middle">
											  Средний
										   </md-option>
										   <md-option value="Low">
											  Низкий
										   </md-option>
										</md-select>
									 </md-input-container>
								  </div>
								  <md-input-container class="md-block">
									 <label>Тема:</label>
									 <input ng-model="task.theme" md-maxlength="50">
								  </md-input-container>
								  <md-input-container class="md-block">
									 <label>Содержание:</label>
									 <textarea ng-model="task.text" md-maxlength="500" rows="3" md-select-on-focus></textarea>
								  </md-input-container>
								  <div layout="row" layout-align="end center">
									 <md-button ng-click="taxTask($event)" class="md-raised md-primary">Подать заявку</md-button>
								  </div>
								</div>
								<div class=" block height100 md-whiteframe-5dp"  ng-controller="newsContoller" ng-cloak>
									<md-subheader class="md-no-sticky blue-title">Новости:</md-subheader>
										<md-list >
									  <md-list-item class="md-3-line" ng-repeat="item in news" >
										<div style="width: 100%;" class="md-list-item-text" >
										  <h3>{{item.title}}</h3>
										  <p>{{item.text}}</p>
											
										  <p align="right">{{item.date}}</p>
											
										</div>
									  </md-list-item>
										
									</md-list>

								</div>
							
						</div>
				</md-tab-body>
			</md-tab>
			<md-tab label="Отчеты">
			<md-tab-body>
			</md-tab-body>
			</md-tab>
			<md-tab label="Администрирование">
			<md-tab-body>
			</md-tab-body>
			</md-tab>
		</md-tabs>
		</div>
		<!--CODE HERE-->
		<!-- Angular Material requires Angular.js Libraries -->
		<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.5.3/angular.min.js"></script>
		<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.5.3/angular-animate.min.js"></script>
		<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.5.3/angular-aria.min.js"></script>
		<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.5.3/angular-messages.min.js"></script>
		<script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
			crossorigin="anonymous"></script>
		<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
		<!-- Angular Material Library -->
		<script src="http://ajax.googleapis.com/ajax/libs/angular_material/1.1.0-rc2/angular-material.min.js"></script>
		<!-- Your application bootstrap  -->
		<script type="text/javascript">
			var blank = angular.module('mainApp', ['ngMaterial']);
			
			blank.controller('newsContoller',  function($scope){
				$scope.news = [
					{
						title: "1c no work",
						text: "1c not work blablabla",
						date: "01.01.0001 00:00"
					},
					{
						title: "1c work",
						text: "1c work blablabla",
						date: "01.01.0001 25:00"
					}
				]
			})
			
			 //TODO noraml entering
			 blank.controller('tasksContoller', ["$scope", function($scope){
				$scope.tasks = [{
								datestart    : "01.01.0001",
								  dateend    : "01.01.0001",
								  status     : "На обработке",
								  theme      : "ЧТо-то там",
								  priority   : "Низкий",
								 text        : "Текст запроса"
								  },
								{
								  datestart  : "01.01.0001",
								  dateend    : "01.01.0001",
								  status     : "На обработке",
								  theme      : "Еще что-то там",
								  priority   : "Высокий" ,
								  text       : "Текст запроса"
								}

						 ]
			 }])

			//         blank.controller('createTaskController', function($scope, $http, $mdDialog){
			//				
			//			 $scope.task = new Task();
			//			 	
			//			 	$scope.taxTask = (ev) => {
			//					//TODO Send to server
			//					$scope.task = new Task();
			//					
			//					$scope.result = new TaskResult(true);
			//					if ($scope.task.getOccupancy()){
			//						//TODO take result
			//						
			//						$scope.result.ok = true;
			//						if($scope.result.ok){
			//							$scope.result.text = "Заявка успешно отправлена"
			//						}else{
			//							$scope.result.text = "Произошла ошибка при отправке заявки"
			//						}
			//					}else{
			//						$scope.result.text = "Не все поля заполнены"
			//					}
			//					
			//					
			//					$mdDialog.show(
			//						
			//					  $mdDialog.alert()
			//						.parent(angular.element(document.querySelector('#popupContainer')))
			//						.clickOutsideToClose(true)
			//						.title($scope.result.text)
			//						.ariaLabel('Alert Dialog Tax')
			//						.ok('ОК')
			//						.targetEvent(ev)
			//						
			//					)	
			//					
			//				}
			//                 
			//         })
			//         
			//         blank.controller('reportTaskController', ["$scope", function($scope){
			//            
			//                 
			//         }])
			
			class RowTask{
			     constructor(datestart,dateend,status, theme, priority, text) {
			         this.datestart     = datestart
			         this.dateend       = dateend
			         this.status        = status
			         this.theme         = theme
			         this.priority      = priority
			         this.text          = text
			     }
			 }
			
			class Task {
			      constructor(username,theme, text, priority) {
			          this.username     = username
			          this.theme        = theme
			          this.text         = text
			          this.priority     = priority
			      }
			
			getOccupancy() {
			
			return this.username != "" && this.theme != "" && this.text != "" && this.priority != ""
			}
			
			
			  }
			
			class TaskResult{
			constructor(ok, text) {
			this.ok = ok;
			this.text = text;
			}
			}
			
			class Result {
			      constructor(status, count) {
			          this.status       = status
			          this.count        = count
			      }
			  }
			
			 //         blank.controller("createTaskController", ["$scope", function($scope) {
			 //
			 //         }])
			
		</script>
			
	</body>
</html>
<!--
	Copyright 2016 Google Inc. All Rights Reserved.
	Use of this source code is governed by an MIT-style license that can be in foundin the LICENSE file at http://material.angularjs.org/license.
	-->